# 쿠키와 세션션 질문 정리

 <details>
  <summary><strong>쿠키란 무엇인가요?</strong></summary>

쿠키는 웹 브라우저가 사용자 정보를 저장하기 위해 사용하는 작은 텍스트 파일이다. 서버와의 HTTP 통신 시, 상태 정보를 유지하기 위해 사용되며, 주로 세션 관리, 사용자 인증, 개인화 및 추적 등에 활용된다.

 <details>
  <summary><strong>쿠키는 어디에 저장되나요?</strong></summary>

쿠키는 클라이언트 측, 즉 사용자의 웹 브라우저 내에 저장된다. 각 브라우저마다 쿠키를 저장하는 방식(예: SQLite 데이터베이스, 텍스트 파일 등)이 다를 수 있다.

  </details>

   <details>
  <summary><strong>쿠키와 관련된 보안 위험에는 무엇이 있을까요?</strong></summary>

- **세션 하이재킹:** 공격자가 사용자의 세션 쿠키를 탈취하면, 해당 사용자의 세션을 가로채어 부정 사용이 가능해진다.
- **XSS(크로스 사이트 스크립팅):** 악의적인 스크립트가 쿠키에 접근하여 쿠키 정보를 탈취할 수 있다.
- **CSRF(크로스 사이트 요청 위조):** 쿠키는 자동으로 요청에 포함되기 때문에, 이를 이용해 공격자가 사용자의 권한으로 의도치 않은 요청을 보낼 위험이 있다.

  </details>

 <details>
  <summary><strong>쿠키의 보안 위험을 방지하기 위한 방법에는 무엇이 있을까요?</strong></summary>

- **HttpOnly 속성 사용:** 이 속성을 적용하면 클라이언트 사이드 스크립트(예: JavaScript)에서 쿠키에 접근할 수 없게 되어 XSS 공격으로부터 보호할 수 있다.
- **Secure 속성 사용:** 이 속성이 적용된 쿠키는 HTTPS 연결을 통해서만 전송되므로 네트워크 상에서 쿠키 탈취 위험을 줄일 수 있다.
- **SameSite 속성 설정:** SameSite 속성을 ‘Strict’ 또는 ‘Lax’로 설정하여 CSRF 공격 위험을 줄일 수 있다.
  </details>

   <details>
  <summary><strong>쿠키의 장단점을 말해주세요.</strong></summary>

**장점:**

- **상태 유지:**
  HTTP는 기본적으로 stateless하지만, 쿠키를 사용하면 사용자 로그인 상태, 선호 설정 등 상태 정보를 유지할 수 있다.
- **경량 데이터 저장:**
  비교적 작은 용량의 데이터를 클라이언트에 저장할 수 있어, 서버 부하를 줄이는 데 도움이 된다.
- **사용자 경험 개선:**
  사용자의 이전 활동이나 설정을 저장하여 개인화된 서비스를 제공할 수 있다.

**단점:**

- **보안 위험:**
  쿠키에 민감한 정보를 저장할 경우 탈취, 변조, 세션 하이재킹 등의 보안 위협에 노출될 수 있습니다. HttpOnly, Secure, SameSite와 같은 옵션을 설정해 보안을 강화할 필요가 있다.
- **용량 제한:**
  쿠키는 일반적으로 4KB 이하의 제한이 있어, 대용량 데이터를 저장하기에는 부적합하다.
- **네트워크 오버헤드:**

  모든 HTTP 요청에 쿠키가 함께 전송되므로, 불필요하게 쿠키 크기가 크거나 많을 경우 네트워크 대역폭에 영향을 줄 수 있다.

  </details>

 <details>
  <summary><strong>Persistence Cookie와 Session Cookie의 차이점은 무엇인가요?</strong></summary>

- **Persistence Cookie (영속 쿠키)**

  - **저장 위치:** 클라이언트 디스크(예: 파일 또는 브라우저의 로컬 스토리지)에 저장된다.
  - **만료 시간:** 만료 날짜가 지정되어 있어, 해당 날짜까지 혹은 사용자가 명시적으로 삭제하기 전까지 유지된다.

- **Session Cookie (세션 쿠키)**

  - **저장 위치:** 브라우저 메모리 내에 저장된다.
  - **만료 시간:** 브라우저를 닫으면 자동으로 삭제된된다.

  </details>

   <details>
  <summary><strong>same site와 same origin의 차이는 무엇인가요</strong></summary>

  - **Same Site**

    쿠키의 SameSite 속성은 브라우저가 쿠키를 전송할 때, 요청이 “동일 사이트”에서 발생한 것인지 여부를 판단하여 전송 여부를 결정하는 역할을 한다. 이 속성은 CSRF(크로스 사이트 요청 위조) 공격을 완화하기 위한 보안 메커니즘이다.

    - **구분 기준:**  
      Same Site는 주로 도메인의 **registrable domain (최상위 도메인 포함)** 을 기준으로 힌다. 예를 들어, `example.com`과 `sub.example.com`은 같은 "사이트"로 간주된다.

- **Same Origin**  
   Same Origin 정책은 웹 브라우저에서 리소스 간 상호작용(예: DOM 접근, 스크립트 실행 등)을 제어하는 보안 모델이다. 이는 보안 상의 이유로, 웹 페이지가 자신의 출처와 다른 출처의 데이터를 임의로 읽거나 조작하지 못하도록 제한한다.

  - **구분 기준:**  
    Same Origin 정책은 **프로토콜(스킴), 호스트(도메인), 포트**가 모두 일치하는 경우에만 동일한 출처로 간주한다. 예를 들어, `https://www.example.com:443`과 `https://www.example.com`은 동일한 출처로 취급되지만, `http://www.example.com` 또는 `https://sub.example.com`은 다른 출처로 취급된다.

  </details>

</details>

<br/>

 <details>
  <summary><strong>쿠키와 세션은 어떤 이유로 등장하게 되었나요?</strong></summary>

- **HTTP의 무상태성(stateless) 문제:**  
  HTTP는 본질적으로 상태를 유지하지 않는 프로토콜이다. 즉, 클라이언트와 서버 간의 요청/응답마다 서로의 상태 정보를 공유하지 않기 때문에, 사용자 인증, 쇼핑카트 등과 같이 상태 정보를 필요로 하는 기능을 구현하기 어려웠다.
- **상태 관리의 필요성:**  
  이러한 문제를 해결하기 위해, 클라이언트나 서버 측에 상태 정보를 저장할 수 있는 방법이 필요해졌고, 그 결과로 **쿠키**(클라이언트 측 저장)와 **세션**(서버 측 저장)이 등장하게 되었다.

 <details>
  <summary><strong>쿠키와 세션의 차이는 무엇인가요?</strong></summary>

- **저장 위치 및 관리 방식:**

  - **쿠키:**
    - **저장 위치:** 클라이언트(브라우저)에 저장되며, 사용자가 직접 접근하거나 조작할 수 있다.
    - **용량 제한:** 비교적 작은 크기(보통 4KB 이하)로 제한되어 있다.
    - **보안:** 민감 정보가 클라이언트에 저장되므로, 탈취나 변조의 위험이 존재한다.
  - **세션:**
    - **저장 위치:** 서버 측에 저장되며, 클라이언트에는 세션을 식별할 수 있는 ID만이 쿠키 등을 통해 전달된다.
    - **용량:** 서버 메모리나 저장소에 정보를 보관하므로, 비교적 많은 양의 데이터를 안전하게 저장할 수 있다.
    - **보안:** 클라이언트가 직접 데이터에 접근할 수 없으므로, 비교적 안전하지만 세션 하이재킹과 같은 공격에 대비해 추가 보안 조치가 필요하다.

  </details>

   <details>
  <summary><strong>규모가 커져 서버가 여러 개일 때 세션 관리는 어떻게 할 수 있을까요?</strong></summary>

- **로드 밸런서의 세션 스티키(Sticky Session):**
  - 클라이언트의 세션 ID를 기반으로 특정 서버에 요청이 계속 전달되도록 하는 방법이다.
  - 단점은 특정 서버에 부하가 집중될 수 있으며, 서버 장애 발생 시 세션 손실 위험이 있다.
- **Session Clustering**
  - 서버 간에 세션 정보를 복제하여, 어느 서버로 요청이 들어오더라도 동일한 세션 데이터를 조회할 수 있게 한다. 다만, 복제 비용과 동기화 문제에 주의해야 한다.
- **Session Storage**

  - **분산 캐시(Distributed Cache):** 각각의 서버에 세션 정보를 저장하는 것이 아니라 외부에 저장소를 만들고 이 서버에 모든 데이터를 저장하는 방식이다.

  </details>

</details>

<br/>

 <details>
  <summary><strong>세션 관리를 위한 방법에 대해 아는 대로 설명해주세요.</strong></summary>

- **쿠키 기반 세션:**
  서버에서 세션 정보를 관리하고, 클라이언트에는 세션 식별자(session id)를 쿠키로 전달하여 요청마다 해당 쿠키를 참조하게 하는 방식이다.
- **URL 리라이팅:**
  쿠키 사용이 제한되거나 비활성화된 환경에서 세션 id를 URL에 포함시켜 세션을 식별하는 방법이다.
- **웹 스토리지 기반 세션:**
  브라우저의 `localStorage`나 `sessionStorage`에 토큰이나 세션 관련 데이터를 저장하여 관리하는 방식이다.
- **JWT(JSON Web Token):**
  서버에서 인증 정보를 포함한 토큰을 생성하여 클라이언트에게 전달하고, 이후 클라이언트는 해당 토큰을 HTTP 헤더(주로 Authorization 헤더)에 포함시켜 요청하는 방식이다.

 <details>
  <summary><strong>URL에 세션 id를 포함할 때 장단점은 무엇일까요?</strong></summary>

- **장점:**
  - **쿠키 비활성 환경에서도 동작:** 쿠키를 지원하지 않는 클라이언트나, 쿠키가 차단된 환경에서도 세션을 유지할 수 있다.
  - **간단 구현:** 별도의 쿠키 관리 로직 없이 URL에 세션 id만 붙이면 되므로 구현이 단순할 수 있다.
- **단점:**

  - **보안 위험:**
    - URL은 로그 파일, 브라우저 기록, 북마크 등을 통해 노출될 수 있어 세션 id가 유출될 위험이 있다.
    - Referrer 헤더를 통해 다른 사이트로 전달될 수 있어 추가 보안 취약점이 존재한다.
  - **URL 길이 증가 및 가독성 저하:**
    - URL에 추가 정보가 붙어 가독성이 떨어지며, 사용자 경험에도 영향을 줄 수 있다.

  </details>

   <details>
  <summary><strong>웹 스토리지 기반으로 세션 관리를 할 때의 장단점은 무엇일까요?</strong></summary>

- **장점:**
  - **클라이언트 제어 용이:**
    - `localStorage`나 `sessionStorage`에 저장한 데이터는 자동으로 HTTP 요청에 포함되지 않으므로, 불필요한 네트워크 전송을 줄일 수 있습니다.
  - **큰 저장 용량:**
    - 쿠키보다 훨씬 큰 용량의 데이터를 저장할 수 있어 다양한 정보를 보관할 수 있습니다.
  - **세션 유지 기간 관리:**
    - `sessionStorage`는 브라우저 탭별로 동작하여, 탭이 닫히면 데이터가 제거되는 등 보다 세밀한 제어가 가능합니다.
- **단점:**

  - **XSS 취약점:**
    - 웹 스토리지는 자바스크립트를 통해 접근 가능하므로, XSS 공격에 취약할 수 있습니다.
  - **자동 전송 기능 부재:**
    - HTTP 요청에 자동으로 포함되지 않기 때문에, 클라이언트에서 직접 헤더에 토큰을 추가하는 로직이 필요합니다.
  - **보안 정책 부재:**
    - 쿠키의 SameSite, HttpOnly, Secure 속성과 같은 추가 보안 옵션을 활용할 수 없으므로, 별도의 보안 처리가 요구됩니다.

  </details>

 <details>
  <summary><strong>JWT에 대해 아는대로 설명해주세요.</strong></summary>

JWT(JSON Web Token)는 JSON 포맷을 기반으로 한 개방형 인증 토큰 표준(RFC 7519)이다. 주로 사용자 인증 및 권한 부여를 위해 사용되며, 토큰 자체에 필요한 정보를 포함하고 있어 별도의 서버 세션 저장소 없이 무상태(stateless) 인증을 가능하게 힌다.

**주요 구성 요소:** 헤더(Header), 페이로드(Payload), 서명(Signature)

**특징 및 장점:**

- **무상태 인증:**
  - 서버는 토큰을 저장하지 않고, 클라이언트가 전송하는 JWT의 서명을 검증하는 방식으로 인증을 처리하여 확장성과 부하 분산에 유리하다.
- **자체 포함(Self-contained):**
  - 토큰 내부에 필요한 모든 정보를 포함하기 때문에, 추가적인 데이터베이스 조회 없이도 사용자 인증 및 권한 검증이 가능하다.
- **확장성:**
  - 클라우드 환경이나 마이크로서비스 아키텍처에서 다양한 서비스 간 인증 정보를 쉽게 공유할 수 있다.

**단점 및 고려사항:**

- **토큰 탈취 시 위험:**
  - JWT가 탈취될 경우, 토큰 만료 시간까지 공격자가 유효한 인증 상태를 사용할 수 있으므로 보안에 주의해야 힌다.
- **토큰 무효화 어려움:**
  - 한 번 발급된 토큰은 기본적으로 서버에 저장되지 않기 때문에, 즉각적인 토큰 폐기(revocation) 처리가 어렵다.
- **크기:**
  - 토큰에 포함되는 정보가 많아질수록 JWT의 크기가 커져 네트워크 전송에 부담이 될 수 있다.
  </details>

</details>
